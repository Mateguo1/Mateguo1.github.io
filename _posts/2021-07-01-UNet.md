---
layout: post
title: U-Net
categories: Semantic Detection
description: U-Net
keywords: U-Net
topmost: false
---

# U-Net

论文题目：U-Net: Convolutional Networks for Biomedical Image Segmentation<br/>论文地址：https://arxiv.org/pdf/1505.04597v1.pdf

作为一个优秀的语义分割模型，可以通过使用较少数据进行训练即可得到不错的效果，下图是原论文中给出的U-Net的网络结构，概括为encode+decode，下图中主要把它从左到右分为三个部分：主干特征提取、加强特征提取、预测。

![](https://raw.githubusercontent.com/Mateguo1/Pictures/master/img/WPS%E5%9B%BE%E7%89%87%E7%BC%96%E8%BE%91.png)

## 1.  主干特征提取：

上图中的最左边的框框里，按照图里的顺序命名为conv1-conv5吧，其实这个结构可以概括为卷积+最大池化的堆叠，当然了它也可以换成VGG、ResNet等网络。

其中的conv1-conv4输出的feature map，都会被当作下一层的输入，并且和对应decode里面的部分进行特征融合（上采样+堆叠），至于卷积核尺寸和特征图的层数图上都表明的很清楚了，这里不在赘述了。

```python
def encode_block(in_channels, out_channels):
    block = torch.nn.Sequential(
        nn.Conv2d(kernel_size=(3, 3), in_channels=in_channels, out_channels=out_channels),
        nn.ReLU(),
        nn.BatchNorm2d(out_channels),
        nn.Conv2d(kernel_size=(3, 3), in_channels=out_channels, out_channels=out_channels),
        nn.ReLU(),
        nn.BatchNorm2d(out_channels)
    )
    return block
```

